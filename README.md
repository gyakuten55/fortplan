# FortPlan - フォートナイト戦略ボード

## 🚀 最新の改善内容

以下の問題が修正・実装されました：

### ✅ 1. マップ拡大機能
- **ズームイン/アウト**: サイドパネルのボタンで拡大・縮小可能
- **リセット機能**: ワンクリックで元のサイズに戻す
- **ズーム表示**: 現在のズーム倍率を%で表示

### ✅ 2. マーカー・要素の移動機能
- **ドラッグ&ドロップ**: 選択ツールで要素をクリック→ドラッグで移動
- **リアルタイム移動**: ドラッグ中にリアルタイムで位置更新
- **全要素対応**: マーカー、テキスト、エリア、円、ルートすべて移動可能

### ✅ 3. ルート作成機能
- **クリック連続追加**: ルートツール選択→クリックで連続ポイント追加
- **ダブルクリック完了**: ダブルクリックでルート作成終了
- **矢印付きライン**: ルートの方向が分かりやすい矢印表示

### ✅ 4. エリア・円のリサイズ機能
- **リサイズハンドル**: 選択された要素に紫色のハンドル表示
- **ドラッグリサイズ**: ハンドルをドラッグして大きさ変更
- **最小サイズ制限**: 極端に小さくならないよう制限

### ✅ 5. その他の修正
- **FortniteAPI統合**: 重複関数を統一、エラーハンドリング改善
- **undo/redo機能**: 配列の深いコピーで正常動作
- **座標変換**: ズーム時の正確な座標計算
- **視認性向上**: 要素に黒い境界線で見やすさアップ

## 🎮 使い方

### 1. アプリケーション起動
```bash
npm run dev
```
ブラウザで http://localhost:3000 にアクセス

### 2. 戦略ボード作成
1. ダッシュボード → 「戦略ボード」
2. 「新しい戦略ボードを作成」
3. 名前を入力して作成

### 3. 戦略描画
1. **マーカー配置**: マーカーツール → マップクリック
2. **ルート描画**: ルートツール → 連続クリック → ダブルクリックで完了
3. **エリア作成**: エリアツール → クリック → 選択してリサイズハンドルでサイズ調整
4. **要素移動**: 選択ツール → 要素クリック → ドラッグで移動
5. **拡大表示**: サイドパネルの拡大/縮小ボタン

## 📋 技術仕様

- **フレームワーク**: Next.js 13 (App Router)
- **スタイリング**: Tailwind CSS
- **描画エンジン**: HTML5 Canvas
- **状態管理**: React hooks (useState, useEffect)
- **データ保存**: ローカルストレージ
- **API統合**: FortniteAPI.io

## 🛠 アーキテクチャ

### Canvas描画システム
- **座標変換**: スクリーン座標⇔Canvas座標の正確な変換
- **レンダリング**: 変換行列を使用したスケール対応描画
- **要素管理**: 階層化された要素描画（背景→グリッド→要素→ハンドル）

### 状態管理
- **UnDo/ReDo**: 要素配列の深いコピーによる履歴管理
- **ドラッグ状態**: move/resizeタイプ別の状態管理
- **ツール状態**: アクティブツールとモード管理

### データ構造
```typescript
interface BoardElement {
  id: string;
  type: 'marker' | 'text' | 'route' | 'area' | 'circle';
  x: number;
  y: number;
  width?: number;
  height?: number;
  radius?: number;
  points?: Point[];
  text?: string;
  style?: ElementStyle;
}
```

## 🎯 今後の拡張予定

- **PDF/PNG エクスポート機能**
- **試合レポート機能**
- **チーム共有機能**
- **決済システム統合**
- **高度な図形ツール**

---

**開発者**: Claude Sonnet (AI Assistant)  
**プロジェクト**: FortPlan v1.0  
**最終更新**: 2025年1月29日
